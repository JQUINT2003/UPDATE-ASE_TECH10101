# Backend Setup - GuÃ­a Completa ğŸš€

## Estructura de Carpetas

```
ase-tech10101/
â”œâ”€â”€ server.js           # Backend server
â”œâ”€â”€ package.json        # Dependencias backend
â”œâ”€â”€ .env               # API Key (crear este)
â””â”€â”€ public/            # Frontend files
    â”œâ”€â”€ index.html
    â”œâ”€â”€ style.css
    â””â”€â”€ script.js
```

## Paso 1: Obtener API Key

1. Ve a: https://console.anthropic.com/
2. Crea cuenta / Inicia sesiÃ³n
3. Ve a: **Settings â†’ API Keys**
4. Click: **Create Key**
5. Copia la key (Â¡guÃ¡rdala ahora!)

## Paso 2: Organizar Archivos

### OpciÃ³n A: Estructura Nueva

```bash
# Crea carpeta del proyecto
mkdir ase-tech10101
cd ase-tech10101

# Crea carpeta public
mkdir public

# Mueve archivos frontend a public/
# index.html â†’ public/index.html
# style.css â†’ public/style.css  
# script.js â†’ public/script.js

# Pon archivos backend en raÃ­z
# server.js â†’ ase-tech10101/server.js
# package.json â†’ ase-tech10101/package.json
```

### OpciÃ³n B: Mantener Actual

```bash
# Si ya tienes los archivos en una carpeta:
cd tu-carpeta-actual

# Crea public y mueve archivos
mkdir public
mv index.html style.css script.js public/

# Pon server.js y package.json en raÃ­z
```

## Paso 3: Configurar .env

Crea archivo `.env` en la raÃ­z:

```bash
ANTHROPIC_API_KEY=sk-ant-api03-xxx-tu-key-aqui-xxx
PORT=3000
```

**âš ï¸ IMPORTANTE:**
- Reemplaza con TU key real
- NO compartas este archivo
- AgrÃ©galo a `.gitignore`

## Paso 4: Instalar Node.js

Si no tienes Node.js:

**Windows/Mac:**
- Descarga: https://nodejs.org/
- Instala versiÃ³n LTS

**Verificar instalaciÃ³n:**
```bash
node --version  # Debe mostrar v18+ o v20+
npm --version   # Debe mostrar 9+ o 10+
```

## Paso 5: Instalar Dependencias

En la carpeta raÃ­z del proyecto:

```bash
npm install
```

Esto instala:
- express (servidor web)
- cors (seguridad)
- dotenv (variables de entorno)

## Paso 6: Iniciar Servidor

```bash
npm start
```

DeberÃ­as ver:
```
Server running on http://localhost:3000
```

## Paso 7: Probar Todo

1. Abre navegador
2. Ve a: `http://localhost:3000`
3. Click en botÃ³n chat ğŸ¤–
4. Escribe: "Hola"
5. Â¡DeberÃ­as recibir respuesta!

## âœ… VerificaciÃ³n RÃ¡pida

**Backend funcionando si:**
- âœ… Servidor inicia sin errores
- âœ… Puedes abrir http://localhost:3000
- âœ… Chat responde mensajes

**Problemas comunes:**
- âŒ "Cannot find module" â†’ Ejecuta `npm install`
- âŒ "API error 401" â†’ Verifica tu API key en .env
- âŒ Puerto ocupado â†’ Cambia PORT en .env
- âŒ CORS error â†’ Reinicia servidor

## ğŸ”§ Comandos Ãštiles

```bash
# Iniciar servidor
npm start

# Modo desarrollo (reinicia auto)
npm run dev

# Ver logs
# En terminal donde corre el servidor

# Detener servidor
# Ctrl + C en terminal
```

## ğŸ“ .gitignore

Crea archivo `.gitignore`:

```
node_modules/
.env
*.log
.DS_Store
```

## ğŸš€ ProducciÃ³n

Para deployar:

### OpciÃ³n 1: Render.com (Gratis)

1. Sube cÃ³digo a GitHub
2. Ve a: https://render.com
3. New â†’ Web Service
4. Conecta tu repo
5. Agrega ANTHROPIC_API_KEY en Environment

### OpciÃ³n 2: Railway.app (Gratis)

1. Ve a: https://railway.app
2. New Project â†’ Deploy from GitHub
3. Agrega variables de entorno
4. Deploy automÃ¡tico

### OpciÃ³n 3: Heroku

```bash
# Instala Heroku CLI
# Luego:
heroku create tu-app
heroku config:set ANTHROPIC_API_KEY=tu-key
git push heroku main
```

## ğŸ”’ Seguridad

**NUNCA expongas:**
- âŒ API key en cÃ³digo frontend
- âŒ Archivo .env en GitHub
- âŒ Keys en URLs

**SIEMPRE:**
- âœ… Usa .env para secrets
- âœ… Agrega .env a .gitignore
- âœ… Rate limiting en producciÃ³n

## ğŸ’° Costos API

Claude API pricing:
- Sonnet 4: ~$3 por millÃ³n tokens
- Incluye input + output tokens
- Monitorea uso en console.anthropic.com

**Estimado mensual:**
- 1000 mensajes/dÃ­a = ~$10-30/mes
- Depende de longitud de mensajes

## ğŸ¯ Testing

Prueba el endpoint directamente:

```bash
curl -X POST http://localhost:3000/api/chat \
  -H "Content-Type: application/json" \
  -d '{
    "messages": [{"role": "user", "content": "Hola"}],
    "system": "Eres un asistente Ãºtil"
  }'
```

## ğŸ“ Soporte

**Errores comunes:**

1. **"ANTHROPIC_API_KEY not found"**
   - Verifica .env existe
   - Verifica sintaxis correcta
   - Reinicia servidor

2. **"Port already in use"**
   - Cambia PORT en .env
   - O mata proceso: `killall node`

3. **"Cannot GET /"**
   - Verifica carpeta public/ existe
   - Verifica archivos en public/

4. **Rate limit error**
   - Espera un minuto
   - Verifica crÃ©ditos en Anthropic

## âœ¨ Siguiente Nivel

**Mejoras recomendadas:**
- [ ] Rate limiting (express-rate-limit)
- [ ] Logging (winston)
- [ ] Error handling mejorado
- [ ] Tests (jest)
- [ ] Database para chat history
- [ ] User authentication
- [ ] WebSockets para streaming

---

**Â¿Todo funcionando?** ğŸ‰
Â¡Ya tienes tu chatbot de Claude funcionando de forma segura!
